import { toParts, toCJS, toESM, isESM, replaceExtension } from '@ractivejs/utils-component'

export default function (content) {
  const srcName = this.resourcePath
  const destName = replaceExtension(this.resourcePath, '.js')
  const parts = toParts(content)
  const moduler = isESM((parts.script && parts.script.code) || '') ? toESM : toCJS
  const { code, map } = moduler({ srcName, destName, parts })
  this.callback(null, code, map)
}
